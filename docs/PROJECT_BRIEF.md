# Kaspi Card Builder — Project Brief

## Цель проекта
Сделать простой self-serve инструмент для продавцов на Kaspi Marketplace, который за 2–3 минуты готовит пакет для загрузки карточек:
- очищенные и проверенные фотографии (под лимиты Kaspi),
- подсказанный заголовок и краткое описание,
- чек-лист обязательных полей/атрибутов по категории,
- экспорт ZIP (images/…) и CSV/README, пригодный для ручной загрузки через Excel-шаблон Kaspi.

## Почему это нужно
Создание карточек на Kaspi — ручной, рутинный и ошибкоопасный процесс. Продавцам приходится:
- удалять фон/ровнять фото, следить за размерами/весом (больно и долго);
- придумывать заголовок/описание, чтобы пройти модерацию и находиться в поиске;
- разбираться с обязательными полями и причинами отклонений.

Готовых «one-click» решений под специфику Kaspi мало; есть разрозненные тулзы (удаление фона, ИИ-описания) и фриланс.

## Профиль пользователя
- Малые и средние продавцы, 50–1000 SKU.
- Контент-менеджер/владелец магазина.
- Работает за ноутбуком/ПК, часто в Telegram.

## KPI MVP
- TTFU (time-to-first-upload): < 15 минут от первого захода до первого скачанного ZIP.
- Ускорение подготовки контента: 10–20 карточек за час.
- Пилоты: ≥ 3 активных магазина за 7–10 дней.
- Конверсия в оплату free→paid: ≥ 5% (план).

## Объём MVP
1) **Photo Fixer (клиент-сайд):** удаление фона, ресайз/кадрирование, сжатие, проверка правил (min/max 500–5000 px по стороне, ≤25 MB/файл; JPEG/WebP предпочтительно).
2) **Title & Description Helper:** шаблон для заголовка из Brand/Type/Model/Key specs; краткие буллеты преимуществ; мульти-языки RU/KZ (минимум — автоперевод).
3) **Category Checklist:** мини-чек-лист «что обычно требует модерация» (по выбранной категории; храним пресеты).
4) **Экспорт:** ZIP со структурой `/images/<SKU>_1.jpg …`, README.md с инструкцией, CSV с полями (name, brand, sku, price, qty, description, image1..imageN, category, attributes_notes).
5) **Лендинг + онбординг:** простая воронка, форма пилота, тариф Free (ограничение по фото) и Pro (подписка).
6) **(Optional) Telegram-бот:** drag&drop в телеграм → ответом ZIP (после Webhook-моста).

> Примечание: точный Excel-шаблон Kaspi варьируется. На MVP даём CSV + README, а в следующих итерациях — генерацию под актуальный XLSX.

## Не-цели MVP
- Полная автоматическая загрузка в Kaspi (нужно продавцу в кабинет).
- Сложные генеративные сцены/рендеры (оставим пресеты).
- Глубокая ERP/учёт (это вне задачи).

## Архитектура (вариант А — быстрый и дешёвый)
- **Frontend-first (Next.js 14, App Router, TypeScript).**
- Обработка изображений **в браузере** (WASM/ONNX) → минимум серверных ресурсов.
- Экспорт ZIP/CSV на клиенте. Сохранение в local/session storage (позже — аккаунты).
- i18n: (RU/KZ/EN).
- Хостинг: **Vercel** (легчайший деплой).

## Архитектура (вариант B — расширяемый)
- Monorepo (Next.js + «light» API routes для auth/billing).
- Бэкенд-служба для пакетной обработки (BullMQ + Upstash Redis) — **после подтверждения спроса**.
- Хранилище объектов (R2/S3) для paid-аккаунтов.
- Биллинг: **Lemon Squeezy** (MoR), webhooks для статуса подписки.

## Техстек
- UI: Next.js 14/15 (App Router), React 18, TypeScript, TailwindCSS, shadcn/ui, Zod, React-Hook-Form, Zustand.
- Обработка изображений (клиент): `@imgly/background-removal` (или `bg-removal` WASM), `browser-image-compression`, `pica`/`sharp-wasm` для ресайза.
- Архивация/экспорт: `jszip`, `file-saver`.
- Аналитика: Plausible.
- Оплата: Lemon Squeezy (checkout overlay).
- Telegram Bot (позже): `grammY` + simple webhook endpoint в Next API Routes.

## Главные экранные потоки
1) **Landing** → CTA «Попробовать бесплатно».
2) **Studio**:
   - Drop images → Auto cleanup → Preview before/after → Batch settings (size/format/naming).
   - Form (Brand/Type/Model/Key spec) → Title preview → Short bullets.
   - Category checklist (пресет) → галочки.
   - Export ZIP/CSV.
3) **Account (позже)**: вход по magic link, лимиты, платежи.

## Структура ZIP
/images
<SKU>_1.jpg
<SKU>_2.jpg
README.md
export.csv
`export.csv` колонки (MVP):
- `sku`, `name`, `brand`, `category`, `price`, `qty`,
- `description`,
- `image1`..`image8` (файловые имена),
- `attributes_notes` (чек-лист того, что заполнить в кабинете).

## Состояния и ограничения
- Поддерживаем **до 50 изображений** за раз (Free) и **до 500** (Pro).
- Поддерживаем **до 8 фото** на карточку (MVP).
- Жёсткая валидация: min/max размер, формат, вес, EXIF-очистка.

## Безопасность и приватность
- Клиент-сайд обработка → фото не покидают устройство (для Free).
- Для Pro (серверная обработка) — подписанный upload URL, авто-удаление через 24–48h.

## Планы после MVP
- Пакетная серверная обработка (очередь).
- Категорийные пресеты (электроника/одежда/косметика).
- Автоперевод RU↔KZ (двуязычные карточки).
- Плагин «Validate before upload» (чек-лист прямо при импорте Excel).
