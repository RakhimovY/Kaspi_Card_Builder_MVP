# MASTER_PROMPT_FOR_CURSOR_PRODUCT_INFO.md — Инструкция для Cursor AI

Ты — Cursor AI. Твоя задача — расширить блок «Информация о товаре» в Studio, не меняя архитектурные принципы проекта.

## Цели
1) Добавить поля и UX из `DEV_STEPS_FOR_CURSOR_PRODUCT_INFO.md` и `PRODUCT_INFO_SPEC.md`.
2) Обеспечить корректный экспорт CSV/ZIP с вариациями.
3) Интегрировать ZXing-сканер и Magic Fill триггеры.
4) Поддержать RU/KZ тексты и валидации.

## Ограничения
- Не трогай секреты на клиенте. Все ключи/вебхуки остаются на сервере.
- Не переписывай фото-пайплайн — он уже реализован.
- Соблюдай `CODE_RULES.md` (TS strict, Zod, RHF, Zustand, i18n).

## Что сделать (поштучно)
1. **БД/Prisma**: добавить `gtin String?`, `variantsJson Json?` в `ProductDraft` (если отсутствуют). Миграции.
2. **API**: PATCH `/api/product-drafts/:id` — поддержать новые поля.
3. **UI Studio (правая панель)**: секции — Идентификация → Контент RU/KZ → Варианты → Атрибуты → Логистика → Категория/Чек-лист → Прогресс.
4. **ZXing**: модалка сканера; результат → `gtin`. Показать CTA «Заполнить Magic Fill».
5. **Magic Fill**: по `gtin`/фото вызвать `/api/magic-fill`, заполнить черновик, сохранить.
6. **Экспорт**: учёт вариаций и сериализация атрибутов; мини-валидатор перед экспортом.
7. **i18n**: добавить ключи из `UI_COPY_AND_I18N_KEYS.md`.
8. **Аналитика**: отправка событий (`scan_barcode`, `magic_fill_used`, `variants_added`, `export_csv_ready`).

## Приёмка (пройдёшь — значит готово)
- Форма сохраняет/восстанавливает все поля, в т.ч. вариации/атрибуты.
- Magic Fill даёт ≥80% автозаполнения для 3 тестовых GTIN.
- Экспорт CSV/ZIP проходит импорт в Kaspi без ошибок.
- RU/KZ интерфейс и контент работают.
- Пакет тестов зелёный, типы строгие.

Следуй этим указаниям пошагово и помечай выполненное в `DEV_STEPS_FOR_CURSOR.md`.