# MAGIC_FILL_AND_BARCODE_PLAN.md — План интеграции Magic Fill и сканера штрихкода

## Поток
1) Пользователь жмёт «Сканировать штрихкод» → ZXing-модалка → получаем `gtin`.
2) Предлагаем «Заполнить Magic Fill» → `POST /api/magic-fill`.
3) Сервер: GTIN-кеш → (опц.) OCR → LLM-парсинг → отдаёт brand/type/model/keySpec, attributes, RU/KZ title/desc, изображения.
4) Клиент: заполняет форму и сохраняет/обновляет **ProductDraft**.

## Требования
- **ZXing**: работоспособность на основных десктоп-браузерах; fallback — ручной ввод.
- **Квоты**: вызов Magic Fill учитывает `assertQuota(userId, "magicFill")`.
- **Кэш GTIN**: повторные запросы быстрее, без лишних внешних вызовов.

## UI
- У поля GTIN: кнопка «Сканировать» + иконка камеры.
- После скана: snackbar «Штрихкод: 4895229101234. Заполнить автоматически?»
- По согласии: показываем спиннер, инлайн-результаты и дифф с текущими полями.

## Приёмка
- 3 тестовых кейса: телефон-аксессуар, футболка, крем — заполняется ≥80% ядра (brand/type/model/keySpec/title/desc).
- Кэш GTIN снижает латентность на повторном запросе.